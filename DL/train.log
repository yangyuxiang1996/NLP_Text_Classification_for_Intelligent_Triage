

(torch)  ✘   /Volumes/yyx/projects/Chinese-Text-Classification/dl   main ±  python train.py
0                        勃起 困难 一年 前 前列腺炎 住院 治疗  万艾可 能 给开 么
1        四 个 半月  女  婴儿  体重 NUM 斤  之前 晚上 夜醒 一 到 两 次 吃奶  ...
2        生 点 小病 就 老 觉得 自己 得了 很 严重 的 病  然后 就 一直 想  特别 紧张...
3        医生 你好 ！ 麻烦 给开 白云山 牌  阿莫西林 胶囊 NUM 乘 NUM 粒  多谢 你...
4        医生 前段 时间 跟 对象 啪啪啪 多 了 现在 感觉 能 硬 起来 但是 硬度 不是 很 ...
                               ...                        
19755                      经期 持续 一个 月  打 了 缩宫 素 三天 还是 没 结束
19756                                   眼睛 干涩  有角膜炎  迎光 流泪
19757                              阴道 痒 要 开 新天 的 苦参 凝胶  谢谢
19758    宝宝 今天 被 刚 煮熟 的 面条 烫 到了 手腕  没 起泡  就是 红肿  怎么 办  ...
19759    医生 您好  我 患有 二 型 糖尿病  遵 医嘱 服用 沙格列汀片 ( 安立泽 )  效果...
Name: text, Length: 19760, dtype: object
Label: 
1     3103
2     2916
8     2443
7     2050
0     2000
6     1501
3     1305
4     1195
10    1191
9     1144
5      912
Name: label, dtype: int64
22122
2021-08-23 12:10:40 vocab.py INFO 加载 word2vec..........
2021-08-23 12:10:40 utils_any2vec.py INFO loading projection weights from /Volumes/yyx/projects/Chinese-Text-Classification/DL/data/w2v_1.bin
2021-08-23 12:10:40 utils_any2vec.py INFO loaded (11565, 300) matrix from /Volumes/yyx/projects/Chinese-Text-Classification/DL/data/w2v_1.bin
count: 11565
0       大夫 我 爸 三 个 月 前 做 了 心 胀 支架 手术  手术 过程 中 支架 部位 出血...
1       本人 现 吃药 NUM 年  二甲双胍 缓释 片 早晚 各 NUM 片  血糖 NUM-NU...
2       上 腹 不 定时 疼痛 一个 多 月  饭后 加重  现 已 去 南京 张 教授 您好 ！ ...
3       感觉 勃起 力度 不够 不 持久  在 和 别的 女人 在一起 的 时候 不 做事 想 做 ...
4                              浑身 起 了 小 疙瘩 后背 叫 痒  没 吃 过药
                              ...                        
1575    医生 你好  我 上厕 所 时 会 拉出 好多 鲜血 来  还 感觉 很 难 拉  平时 不...
1576    你好 医生  我 家 小孩 有 多动症  服用 小儿 智力 糖浆  盐酸 硫 必 利片恩华 ...
1577                                  包皮龟头炎  龟头 有 红色 小 疙瘩
1578                                早泄  之前 做 B 超 说 前列腺 钙化
1579          医生 你好 我 有 过敏性鼻炎  想 买 两 种 喷剂  你 看看 可以 开个 方 吗
Name: text, Length: 1580, dtype: object
Label: 
0     591
1     173
2     162
8     137
7     114
6      84
3      72
4      67
10     66
9      63
5      51
Name: label, dtype: int64
0       我 有 经常 有 胃炎  现在 还有 口腔溃疡  胃口 有些 段 时间 还 不好  我 怀疑...
1       李主任  我 父亲 吃 德巴金 快 一个 月 了  最近 几 天 精神 不是 很 好  而且...
2       ? NUM 年 NUM 月 支架 NUM 个  今年 复查 了 造影  请王 医生 看看 有...
3       NUM 年 左右 发现 有 灰指甲  没 怎么 在意 涂 了 点 亮甲  后来 越来越 严重...
4       多年 之前 就 有 手淫  现在 早泄  刚 进入 阴道 就 有 想射 精  包皮 割 了 ...
                              ...                        
1575    老婆 怀孕 几个 月  几个 月 没 过 性生活  昨天 想 过 性生活  硬 不 起来  ...
1576    医生  我 儿子 还有 点 流鼻涕  现在 嘴 角 又 起泡 了  您 给 看看 吧  操心...
1577    本人 年 前 NUM 年 NUM 月 右耳 出现 间断性 耳鸣  但 没有 什么 影响  N...
1578            经期 延后  肚子 以及 手脚 冰凉  经期 第一 天 会 感到 不适  有血 块
1579    医生 你好  冬天 的 时候 公司 组织 了 一次 体检  报告 中 显示 尿 潜血 NUM...
Name: text, Length: 1580, dtype: object
Label: 
0     591
1     172
2     163
8     136
7     114
6      83
3      73
10     67
4      66
9      64
5      51
Name: label, dtype: int64
2021-08-23 12:10:40 train.py INFO <bound method Module.parameters of LSTMModel(
  (embedding): Embedding(22126, 300)
  (lstm): LSTM(300, 512, batch_first=True, bidirectional=True)
  (dropout): Dropout(p=0.5, inplace=False)
  (fc1): Linear(in_features=1024, out_features=512, bias=True)
  (fc2): Linear(in_features=512, out_features=11, bias=True)
)>
2021-08-23 12:10:40 train.py INFO ***** Running training *****
2021-08-23 12:10:40 train.py INFO   Num examples = 19760
2021-08-23 12:10:40 train.py INFO   Num Epochs = 10
2021-08-23 12:10:40 train.py INFO   batch size = 32
2021-08-23 12:10:40 train.py INFO   Num batches = 6180
2021-08-23 12:10:40 train.py INFO Epoch [1/10]
2021-08-23 12:10:40 train.py INFO token_ids: tensor([[    2, 11828, 16028,  ...,     0,     0,     0],
        [    2, 22054,  6682,  ...,     0,     0,     0],
        [    2,  8433, 11857,  ...,     0,     0,     0],
        ...,
        [    2, 19117,  1421,  ...,     0,     0,     0],
        [    2,  7241,  3832,  ...,     0,     0,     0],
        [    2,  9406,  9605,  ...,     0,     0,     0]])
 
2021-08-23 12:10:40 train.py INFO token_ids shape: torch.Size([32, 96])
 
2021-08-23 12:10:40 train.py INFO attention_mask: None

2021-08-23 12:10:40 train.py INFO token_type_ids: None

2021-08-23 12:10:40 train.py INFO labels: tensor([9, 7, 6, 2, 0, 1, 0, 7, 0, 2, 8, 1, 2, 1, 8, 1, 3, 2, 4, 0, 8, 4, 7, 1,
        6, 2, 6, 7, 0, 6, 7, 9])

2021-08-23 12:10:40 train.py INFO labels shape: torch.Size([32])

2021-08-23 12:25:15 train.py INFO Epoch [2/10]
2021-08-23 12:25:15 train.py INFO token_ids: tensor([[    2,  9406, 16312,  ...,     0,     0,     0],
        [    2,  8078,  3493,  ...,     0,     0,     0],
        [    2, 11606, 17658,  ...,     0,     0,     0],
        ...,
        [    2, 19726,  4833,  ...,     0,     0,     0],
        [    2,  6869,  6874,  ...,     0,     0,     0],
        [    2,   765,  3493,  ...,     0,     0,     0]])
 
2021-08-23 12:25:15 train.py INFO token_ids shape: torch.Size([32, 130])
 
2021-08-23 12:25:15 train.py INFO attention_mask: None

2021-08-23 12:25:15 train.py INFO token_type_ids: None

2021-08-23 12:25:15 train.py INFO labels: tensor([ 9,  1,  1,  8,  4,  1,  8,  7,  1, 10,  9, 10,  9,  4,  4,  0,  6,  0,
         8,  7,  4,  6,  2,  8,  1, 10, 10,  2,  9,  5,  1, 10])

2021-08-23 12:25:15 train.py INFO labels shape: torch.Size([32])

/usr/local/anaconda3/envs/torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/usr/local/anaconda3/envs/torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/usr/local/anaconda3/envs/torch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
2021-08-23 12:33:37 train.py INFO result: 
              precision    recall  f1-score   support

          男科     0.9500    0.0321    0.0622       591
         皮肤科     0.2030    0.8671    0.3289       173
          其它     0.2258    0.6914    0.3404       162
          妇科     0.0000    0.0000    0.0000        72
       心血管内科     0.3333    0.0448    0.0789        67
        耳鼻喉科     0.0000    0.0000    0.0000        51
        消化内科     0.0000    0.0000    0.0000        84
        小儿内科     0.3795    0.5526    0.4500       114
        呼吸内科     0.3448    0.3650    0.3546       137
        内分泌科     0.0000    0.0000    0.0000        63
        神经内科     0.0000    0.0000    0.0000        66

    accuracy                         0.2513      1580
   macro avg     0.2215    0.2321    0.1468      1580
weighted avg     0.4721    0.2513    0.1607      1580

2021-08-23 12:33:37 train.py INFO Confusion matrix: 
[[ 19 519  53   0   0   0   0   0   0   0   0]
 [  1 150  19   0   0   0   0   1   2   0   0]
 [  0  27 112   0   0   0   0   8  14   0   1]
 [  0  31  37   0   0   0   0   2   2   0   0]
 [  0   1  60   0   3   0   0   0   3   0   0]
 [  0   0   8   0   0   0   0  17  26   0   0]
 [  0   2  75   0   0   0   0   2   5   0   0]
 [  0   4   9   1   1   0   0  63  36   0   0]
 [  0   2  12   0   0   0   0  73  50   0   0]
 [  0   2  57   0   3   0   1   0   0   0   0]
 [  0   1  54   0   2   0   2   0   7   0   0]]
2021-08-23 12:33:37 train.py INFO Iter:1000, Train Loss:1.7515, Train Acc:40.62%, Val Loss:1.4400, Val Acc:25.13%, Time:0:22:57 *
2021-08-23 12:38:23 train.py INFO Epoch [3/10]
2021-08-23 12:38:23 train.py INFO token_ids: tensor([[    2,  2244,  3832,  ...,     0,     0,     0],
        [    2, 22072, 22111,  ...,  9161,  3615,     3],
        [    2,  1446,  7055,  ...,     0,     0,     0],
        ...,
        [    2, 11384,  6859,  ...,     0,     0,     0],
        [    2, 11176,  9259,  ...,     0,     0,     0],
        [    2, 20887,  3742,  ...,     0,     0,     0]])
 
2021-08-23 12:38:23 train.py INFO token_ids shape: torch.Size([32, 89])
 
2021-08-23 12:38:23 train.py INFO attention_mask: None

2021-08-23 12:38:23 train.py INFO token_type_ids: None

2021-08-23 12:38:23 train.py INFO labels: tensor([ 7,  6,  0,  0,  1,  3,  0,  9,  0,  1,  6,  1,  0,  9,  6,  7,  2,  0,
         2,  7,  7,  8, 10,  2,  8,  9,  7,  0,  2,  2,  0,  0])

2021-08-23 12:38:23 train.py INFO labels shape: torch.Size([32])

2021-08-23 12:51:06 train.py INFO Epoch [4/10]
2021-08-23 12:51:06 train.py INFO token_ids: tensor([[    2,  3832, 11606,  ...,     0,     0,     0],
        [    2, 16768, 19233,  ...,     0,     0,     0],
        [    2,  3832,  9406,  ...,     0,     0,     0],
        ...,
        [    2, 13807,  6103,  ...,     0,     0,     0],
        [    2,  3832,  2244,  ...,     0,     0,     0],
        [    2,  6081,   802,  ...,     0,     0,     0]])
 
2021-08-23 12:51:06 train.py INFO token_ids shape: torch.Size([32, 106])
 
2021-08-23 12:51:06 train.py INFO attention_mask: None

2021-08-23 12:51:06 train.py INFO token_type_ids: None

2021-08-23 12:51:06 train.py INFO labels: tensor([ 4,  2,  2,  9,  4,  3,  1,  1,  9,  8,  3, 10,  5,  1,  1,  6,  6,  0,
         5,  4,  4,  9,  1,  0,  8,  1,  3,  8,  2,  1,  8,  0])

2021-08-23 12:51:06 train.py INFO labels shape: torch.Size([32])

2021-08-23 12:54:26 train.py INFO result: 
              precision    recall  f1-score   support

          男科     0.9779    0.8968    0.9356       591
         皮肤科     0.8556    0.8902    0.8725       173
          其它     0.4248    0.5926    0.4948       162
          妇科     0.9016    0.7639    0.8271        72
       心血管内科     0.8600    0.6418    0.7350        67
        耳鼻喉科     0.7619    0.6275    0.6882        51
        消化内科     0.8182    0.8571    0.8372        84
        小儿内科     0.6165    0.7193    0.6640       114
        呼吸内科     0.6934    0.6934    0.6934       137
        内分泌科     0.7500    0.8571    0.8000        63
        神经内科     0.5306    0.3939    0.4522        66

    accuracy                         0.7842      1580
   macro avg     0.7446    0.7212    0.7273      1580
weighted avg     0.8053    0.7842    0.7906      1580

2021-08-23 12:54:26 train.py INFO Confusion matrix: 
[[530   9  38   1   1   0   2   0   0   2   8]
 [  4 154  14   1   0   0   0   0   0   0   0]
 [  4  12  96   3   2   1   8  12  10   8   6]
 [  4   1   9  55   0   0   0   0   0   2   1]
 [  0   0   9   0  43   0   2   0   3   6   4]
 [  0   1   2   0   0  32   0   6   8   0   2]
 [  0   0   8   0   0   0  72   1   2   0   1]
 [  0   1  11   0   0   3   2  82  15   0   0]
 [  0   0   4   0   0   6   1  31  95   0   0]
 [  0   0   7   1   0   0   0   0   0  54   1]
 [  0   2  28   0   4   0   1   1   4   0  26]]
2021-08-23 12:54:26 train.py INFO Iter:2000, Train Loss:0.6397, Train Acc:81.25%, Val Loss:0.6564, Val Acc:78.42%, Time:0:43:46 *
2021-08-23 13:04:05 train.py INFO Epoch [5/10]
2021-08-23 13:04:05 train.py INFO token_ids: tensor([[    2,  9406,  9605,  ...,     0,     0,     0],
        [    2, 13807,  8921,  ...,     0,     0,     0],
        [    2,  3832,  9406,  ...,     0,     0,     0],
        ...,
        [    2, 17554, 17384,  ...,     0,     0,     0],
        [    2, 12488,  6416,  ...,     0,     0,     0],
        [    2,  3832,  2244,  ...,     0,     0,     0]])
 
2021-08-23 13:04:05 train.py INFO token_ids shape: torch.Size([32, 100])
 
2021-08-23 13:04:05 train.py INFO attention_mask: None

2021-08-23 13:04:05 train.py INFO token_type_ids: None

2021-08-23 13:04:05 train.py INFO labels: tensor([ 5,  1,  0,  8,  0,  0,  7,  2,  0,  2,  2,  3,  7,  0,  4,  1,  6,  4,
         2,  2,  3,  9,  1, 10,  2,  6,  5,  7,  8,  2,  1,  4])

2021-08-23 13:04:05 train.py INFO labels shape: torch.Size([32])

2021-08-23 13:15:15 train.py INFO result: 
              precision    recall  f1-score   support

          男科     0.9850    0.8900    0.9351       591
         皮肤科     0.8125    0.9017    0.8548       173
          其它     0.4929    0.6420    0.5576       162
          妇科     0.8611    0.8611    0.8611        72
       心血管内科     0.8226    0.7612    0.7907        67
        耳鼻喉科     0.7955    0.6863    0.7368        51
        消化内科     0.8434    0.8333    0.8383        84
        小儿内科     0.8118    0.6053    0.6935       114
        呼吸内科     0.6954    0.8832    0.7781       137
        内分泌科     0.8095    0.8095    0.8095        63
        神经内科     0.6833    0.6212    0.6508        66

    accuracy                         0.8139      1580
   macro avg     0.7830    0.7723    0.7733      1580
weighted avg     0.8323    0.8139    0.8186      1580

2021-08-23 13:15:15 train.py INFO Confusion matrix: 
[[526  20  33   4   1   0   1   0   0   2   4]
 [  2 156  13   1   0   0   0   0   1   0   0]
 [  3  14 104   5   3   3   8   4   8   4   6]
 [  1   0   6  62   0   0   0   0   0   2   1]
 [  2   0   4   0  51   0   0   0   3   4   3]
 [  0   0   3   0   0  35   0   1  10   0   2]
 [  0   0  10   0   0   0  70   2   2   0   0]
 [  0   1  11   0   0   3   2  69  27   0   1]
 [  0   0   2   0   1   3   1   9 121   0   0]
 [  0   0   8   0   2   0   0   0   0  51   2]
 [  0   1  17   0   4   0   1   0   2   0  41]]
2021-08-23 13:15:15 train.py INFO Iter:3000, Train Loss:0.8723, Train Acc:68.75%, Val Loss:0.5932, Val Acc:81.39%, Time:1:04:35 *
2021-08-23 13:17:04 train.py INFO Epoch [6/10]
2021-08-23 13:17:04 train.py INFO token_ids: tensor([[    2,  3832,  2244,  ...,     0,     0,     0],
        [    2,  3832,  9406,  ...,     0,     0,     0],
        [    2,  9605, 18853,  ...,     0,     0,     0],
        ...,
        [    2,  2771, 11009,  ...,     0,     0,     0],
        [    2,  9492, 13226,  ...,     0,     0,     0],
        [    2, 14684, 17241,  ...,     0,     0,     0]])
 
2021-08-23 13:17:04 train.py INFO token_ids shape: torch.Size([32, 101])
 
2021-08-23 13:17:04 train.py INFO attention_mask: None

2021-08-23 13:17:04 train.py INFO token_type_ids: None

2021-08-23 13:17:04 train.py INFO labels: tensor([ 2,  5,  3,  4,  1,  6,  8,  8,  5,  9,  1,  1,  0,  8,  8,  0,  8,  2,
         5,  9,  3,  4,  5,  6,  2,  1, 10,  6,  6,  4,  8,  9])

2021-08-23 13:17:04 train.py INFO labels shape: torch.Size([32])

2021-08-23 13:29:38 train.py INFO Epoch [7/10]
2021-08-23 13:29:38 train.py INFO token_ids: tensor([[    2,  4754,   944,  ...,     0,     0,     0],
        [    2,  3832,  2244,  ...,     0,     0,     0],
        [    2,  3832,  9406,  ...,     0,     0,     0],
        ...,
        [    2,  3861, 13642,  ...,     0,     0,     0],
        [    2, 22087, 14966,  ...,     0,     0,     0],
        [    2, 13633,  9114,  ...,     0,     0,     0]])
 
2021-08-23 13:29:38 train.py INFO token_ids shape: torch.Size([32, 112])
 
2021-08-23 13:29:38 train.py INFO attention_mask: None

2021-08-23 13:29:38 train.py INFO token_type_ids: None

2021-08-23 13:29:38 train.py INFO labels: tensor([ 6,  2, 10,  2,  0,  1,  0,  1,  1,  7,  6,  1,  8,  7,  2,  4,  1,  3,
         0,  5,  2,  1,  3,  5,  1,  2,  6,  4,  6,  6,  1,  1])

2021-08-23 13:29:38 train.py INFO labels shape: torch.Size([32])

2021-08-23 13:35:57 train.py INFO result: 
              precision    recall  f1-score   support

          男科     0.9786    0.9272    0.9522       591
         皮肤科     0.8523    0.8671    0.8596       173
          其它     0.5211    0.6852    0.5920       162
          妇科     0.8857    0.8611    0.8732        72
       心血管内科     0.8475    0.7463    0.7937        67
        耳鼻喉科     0.7895    0.5882    0.6742        51
        消化内科     0.8235    0.8333    0.8284        84
        小儿内科     0.6408    0.7982    0.7109       114
        呼吸内科     0.8136    0.7007    0.7529       137
        内分泌科     0.8000    0.8889    0.8421        63
        神经内科     0.7347    0.5455    0.6261        66

    accuracy                         0.8228      1580
   macro avg     0.7897    0.7674    0.7732      1580
weighted avg     0.8377    0.8228    0.8266      1580

2021-08-23 13:35:57 train.py INFO Confusion matrix: 
[[548  14  19   3   1   0   1   0   0   2   3]
 [  2 150  21   0   0   0   0   0   0   0   0]
 [  6   9 111   3   2   1   8  10   3   5   4]
 [  2   1   3  62   0   0   0   1   0   2   1]
 [  2   0   4   0  50   0   0   0   3   5   3]
 [  0   0   8   0   0  30   0   5   7   0   1]
 [  0   0  11   0   0   0  70   1   2   0   0]
 [  0   1  10   0   0   2   3  91   6   0   1]
 [  0   0   2   0   0   5   2  32  96   0   0]
 [  0   0   4   2   1   0   0   0   0  56   0]
 [  0   1  20   0   5   0   1   2   1   0  36]]
2021-08-23 13:35:57 train.py INFO Iter:4000, Train Loss:0.4917, Train Acc:84.38%, Val Loss:0.5599, Val Acc:82.28%, Time:1:25:17 *
2021-08-23 13:42:37 train.py INFO Epoch [8/10]
2021-08-23 13:42:37 train.py INFO token_ids: tensor([[    2, 15356, 13837,  ...,     0,     0,     0],
        [    2, 18649, 19850,  ...,     0,     0,     0],
        [    2,  2244,  3832,  ...,     0,     0,     0],
        ...,
        [    2,  1214,  1270,  ...,     0,     0,     0],
        [    2, 22087, 11627,  ...,     0,     0,     0],
        [    2,  3832,  2244,  ...,     0,     0,     0]])
 
2021-08-23 13:42:37 train.py INFO token_ids shape: torch.Size([32, 94])
 
2021-08-23 13:42:37 train.py INFO attention_mask: None

2021-08-23 13:42:37 train.py INFO token_type_ids: None

2021-08-23 13:42:37 train.py INFO labels: tensor([ 6,  5,  5,  4,  2,  8,  1,  1,  2,  0,  7,  5,  1,  9,  8,  2,  8,  7,
         9,  8,  1,  9,  4, 10, 10,  0,  4,  7,  7,  3,  1,  2])

2021-08-23 13:42:37 train.py INFO labels shape: torch.Size([32])

2021-08-23 13:55:16 train.py INFO Epoch [9/10]
2021-08-23 13:55:16 train.py INFO token_ids: tensor([[    2, 17613, 19440,  ...,     0,     0,     0],
        [    2,  2244,  7718,  ...,     0,     0,     0],
        [    2, 11171,  5541,  ...,     0,     0,     0],
        ...,
        [    2,  1406,  2244,  ...,     0,     0,     0],
        [    2,  3832,  9406,  ...,     0,     0,     0],
        [    2, 19643, 20856,  ...,     0,     0,     0]])
 
2021-08-23 13:55:16 train.py INFO token_ids shape: torch.Size([32, 64])
 
2021-08-23 13:55:16 train.py INFO attention_mask: None

2021-08-23 13:55:16 train.py INFO token_type_ids: None

2021-08-23 13:55:16 train.py INFO labels: tensor([ 1,  7,  8,  0,  7,  8,  0,  7,  8,  2,  8,  2,  6,  8,  3,  1,  4,  3,
         0,  2, 10,  2,  3,  9,  0,  0,  7,  0,  0, 10,  3,  0])

2021-08-23 13:55:16 train.py INFO labels shape: torch.Size([32])

2021-08-23 13:56:48 train.py INFO result: 
              precision    recall  f1-score   support

          男科     0.9835    0.9103    0.9455       591
         皮肤科     0.8508    0.8902    0.8701       173
          其它     0.4907    0.6543    0.5608       162
          妇科     0.8732    0.8611    0.8671        72
       心血管内科     0.8814    0.7761    0.8254        67
        耳鼻喉科     0.8333    0.5882    0.6897        51
        消化内科     0.7805    0.7619    0.7711        84
        小儿内科     0.8000    0.6667    0.7273       114
        呼吸内科     0.7076    0.8832    0.7857       137
        内分泌科     0.8028    0.9048    0.8507        63
        神经内科     0.8627    0.6667    0.7521        66

    accuracy                         0.8253      1580
   macro avg     0.8061    0.7785    0.7860      1580
weighted avg     0.8441    0.8253    0.8302      1580

2021-08-23 13:56:48 train.py INFO Confusion matrix: 
[[538  11  32   6   1   0   0   0   0   1   2]
 [  2 154  15   0   0   0   0   1   1   0   0]
 [  5  13 106   2   3   2   9   4   9   6   3]
 [  0   1   5  62   0   0   0   2   0   2   0]
 [  2   0   3   0  52   0   1   0   4   5   0]
 [  0   1   7   0   0  30   0   1  11   0   1]
 [  0   0  16   0   0   0  64   1   3   0   0]
 [  0   1  10   1   0   1   3  76  21   0   1]
 [  0   0   2   0   0   2   3   9 121   0   0]
 [  0   0   5   0   1   0   0   0   0  57   0]
 [  0   0  15   0   2   1   2   1   1   0  44]]
2021-08-23 13:56:48 train.py INFO Iter:5000, Train Loss:0.1790, Train Acc:93.75%, Val Loss:0.6296, Val Acc:82.53%, Time:1:46:08 *
2021-08-23 14:12:24 train.py INFO Epoch [10/10]
2021-08-23 14:12:24 train.py INFO token_ids: tensor([[    2, 19800, 21908,  ...,     0,     0,     0],
        [    2,  9605,  8466,  ...,     0,     0,     0],
        [    2,  9605,  5571,  ...,     0,     0,     0],
        ...,
        [    2, 15068,  9746,  ...,     0,     0,     0],
        [    2,  3832,  2244,  ...,     0,     0,     0],
        [    2, 15058, 14906,  ...,     0,     0,     0]])
 
2021-08-23 14:12:24 train.py INFO token_ids shape: torch.Size([32, 111])
 
2021-08-23 14:12:24 train.py INFO attention_mask: None

2021-08-23 14:12:24 train.py INFO token_type_ids: None

2021-08-23 14:12:24 train.py INFO labels: tensor([ 5,  3,  8,  2,  1,  0,  1,  8,  1,  0,  0,  2,  4,  8,  1,  0,  3,  2,
         6,  0,  3,  9,  3,  2,  8,  5,  5,  5,  1,  2, 10, 10])

2021-08-23 14:12:24 train.py INFO labels shape: torch.Size([32])

2021-08-23 14:23:54 train.py INFO result: 
              precision    recall  f1-score   support

          男科     0.9923    0.8765    0.9308       591
         皮肤科     0.8021    0.8902    0.8438       173
          其它     0.4386    0.6173    0.5128       162
          妇科     0.8939    0.8194    0.8551        72
       心血管内科     0.8276    0.7164    0.7680        67
        耳鼻喉科     0.6552    0.7451    0.6972        51
        消化内科     0.8571    0.7857    0.8199        84
        小儿内科     0.7345    0.7281    0.7313       114
        呼吸内科     0.8264    0.7299    0.7752       137
        内分泌科     0.8116    0.8889    0.8485        63
        神经内科     0.6053    0.6970    0.6479        66

    accuracy                         0.8025      1580
   macro avg     0.7677    0.7722    0.7664      1580
weighted avg     0.8288    0.8025    0.8116      1580

2021-08-23 14:23:54 train.py INFO Confusion matrix: 
[[518  20  40   4   1   0   1   0   0   1   6]
 [  1 154  16   0   0   0   0   1   0   0   1]
 [  2  17 100   3   4   5   5   4   2   7  13]
 [  0   0   9  59   0   0   0   0   0   2   2]
 [  1   0   8   0  48   0   0   1   3   3   3]
 [  0   0   6   0   0  38   0   2   3   0   2]
 [  0   0  14   0   0   1  66   1   2   0   0]
 [  0   1  14   0   1   1   2  83  11   0   1]
 [  0   0   3   0   0  12   2  20 100   0   0]
 [  0   0   5   0   0   0   0   0   0  56   2]
 [  0   0  13   0   4   1   1   1   0   0  46]]
2021-08-23 14:23:54 train.py INFO Iter:6000, Train Loss:0.3000, Train Acc:84.38%, Val Loss:0.7028, Val Acc:80.25%, Time:2:13:13 